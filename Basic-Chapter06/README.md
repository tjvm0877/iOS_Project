# iOS_Project

## Chapter 06. 사용자에게 메시지를 전달하는 방법

앱 내에서 사용자에게 메시지를 전달 방법

1. 메시지창(알림창)

   - 사용자에게 즉각적으로 메시지를 전달할 수 있으면서 주의를 환기시킬 수 있을 뿐만 아니라, 다른 화면 요소에 묻혀 인식되지 않을 위험성도 낮아 주로 경고, 알림 메시지 등에서 널리 사용되는 창이다.
   - 다만 알림창의 경우 앱이 실행 중일 때만 동작한다는 치명적인 단점을 가짐,  앱이 실행하지 않으면 알림참을 노출할 수 없는 한계를 가졌다.

2. 푸시 메시지

   - 알림창의 한계를 보완하기 위해 고안된 기능, 앱을 켜 놓지 않아도 아이폰 화면에 전달되는 메시지

   - 로컬 노티피케이션 (로컬 푸시)
     - 앱 내부의 특정 프로세스에 의해 등록된 메시지를 iOS가 전달하는 방식
   - 푸시 노티피케이션 (푸시 알림)
     - APNs(Apple Push Notification Service)라는 애플 코유의 메시징 시스템에게 보낸 메시지가 네트워크를 통해 전달되는 방식



### 6.1 메시지 알림 창 - UIAlertController

UIAlertController : iOS에서 메시지 창을 구현하는 뷰 컨트롤러의 일종
알림창이 화면에 표시되고 있는 동안 앱의 다른 기능을 사용할 수 없는 범위는 사용자의 터치 또는 드래그와 같은 이벤트로 제한된다.
애플리케이션 자체적으로 실행하는 내용이 있다면 알림창이 표시되고 있더랃 계속 실행된다.
UIAlerController가 비동기(Asynchronize)방식으로 실행된다.

UIAlertController의 형태는 크게 2가지 형태

1. 알림창
   - 화면 중앙에 표시
   - 버튼이 2개 일 때 알림창은 나란히 배치
   - 모달(Modal, 창이 닫힐 때 까지 그 창을 제외한 화면의 다른 부분은 반응할 수 없도록 잠김) 방식으로 화면에 표시 (액션 시트와의 결정적 차이점)

1. 액션 시트
   - 화면 하단에 표시
   - 버튼이 2개 일 때 버튼이 세로로 배치
   - 메시지가 떠 있는 동안에도 메시지 창이 아닌 다른 영역을 건드릴 수 있으며 , 그 결과로 액션 시트 창이 닫힌다.



### 6.2 로컬 알림

**로컬 알림** : 앱 내부에서 만든 특정 메시지를 iOS알림 센터를 통해 전달하는 방법, 앱이 종료되어 있거나 백그라운드 상태일 때 메시지를 전달할 수 있는 대표적인 방법 중 하나.

**UserNotification** : 로컬 알림을 처리하는 객체는 전통적으로 UILocalNotification이었으나 UIKit 프레임워크에 정의된 객체였다. 애플이 사용자 알림에 관한 모든 것을 전담 처리할 UserNotification 프레임워크를 iOS 10부터 공개 되었다. 
이 UserNotification은 사용자 알림을 처리하기 위해 iOS 10부터 새롭게 도입된 알림 전용 프레임 워크로, User와 Notification의 첫 철자를 딴 UN 접두어를 사용해 객체 이름을 정의한다. 기존의 알림 관련 객체에서는 로컬 알림과 서버 알림을 위한 객체가 각각 나누어져 있었지만, UserNotification 프레임워크에서 로컬 알림과 서버 알림의 차이는 단순히 구분값에 지나지 않으므로, 통합적으로 구현 가능하다는 장점이 있다. 



UserNotification 프레임워크에서 눈여겨봐야 할 객체

UILocalNotification 객체를 통해 정의했던 각종 속성들은 알림 콘텐츠, 알림 발송 조건, 알림 요청의 3가지로 분화 되었다. 이 객체는 아래의 1~3에 해당한다.

1. UNMutableNotificationContent
   - 알림에 필요한 메시지와 같은 기본적인 속성을 담는 알림 콘텐츠 역할
   - 이 객체를 통해 로컬 알림 타이틀, 서브 타이틀 및 알림 메시지를 설정할 수 있으며 앱 아이콘에 표시될 배지나 사운드 설정도 모두 이 객체를 통해 설정한다.
   - 비슷한 객체로 **UNNotificationContent**가 있는데 이 객체는 수정이 불가능하며 객체로부터 속성을 읽어들일 수만 있는 특성을 가진다. 따라서 기존에 등록된 알림 콘텐츠를 읽을 때에만 사용할 수 있으며 속성을 반드시 설정하려면 반드시 UNMutableNotificationContent객체를 사용해야 한다.
2. UNTimeIntervalNotificationTrigger
   - 알림 발송 조건을 관리, 설정할 수 있는 속성은 발생 시각과 반복 여부이다.
   - "몇 분 후"등과 같이 시간 간격을 설정하여 알림 메시지를 발송할 수 있다.
   - 입력값의 단위는 초(s)이다.
   - 만약 하루 중 특정 시각에 맞추어 알림 메시지를 전송하고 싶다면 **UNCalendarNotificationTrigger**객체를 사용하면 된다.
3. UNNotificationRequest
   - **UNMutableNotificationContent**, **UNTimeIntervalNotificationTrigger**를 통해 알림 발생 조건이 준비되면 이들을 모아 알림 요청 객체를 만들어야 한다. 이 때 사용하는 컨텐츠가 바로 **UNNotificationRequest**이다.
   - 알림 콘텐츠 객체와 알림 발송 조건 객체를 인자값으로 하여 이 클래스를 초기화하면 그 결과로 알림 요청 객체가 생성되었다.
4. UNUserNotificationCenter
   - 실제 발송을 담당하는 센터, 등록된 알림 내용을 확인하고 정해진 시각에 발송하는 역할
   - 싱글턴 방식으로 동작하기 때문에 따로 인스턴스를 생성하지 않고 current() 메소드를 통해 참조 정보만 가져올 수 있다.
